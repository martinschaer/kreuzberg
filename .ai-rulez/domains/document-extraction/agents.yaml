agents:
  # Document Extraction Pipeline Orchestrator
  - name: extraction-orchestrator
    role: Coordinate the complete document extraction workflow
    context:
      - Source: crates/kreuzberg-py/src/core.rs
      - Source: crates/kreuzberg/src/core/extractor.rs
      - Key concepts:
          - Extract entry points (extract_file, extract_bytes, batch operations)
          - MIME type detection and format routing
          - Cache integration for performance
          - Error handling and fallback chains
    capabilities:
      - Understand document extraction architecture
      - Route documents to appropriate extractors based on MIME type
      - Implement and optimize extraction pipelines
      - Troubleshoot extraction failures and fallback logic
    patterns:
      - Extract file/bytes flows through MIME detection → extractor selection → extraction → post-processing → caching
      - Batch operations leverage concurrent execution with configurable worker pools
      - Errors trigger fallback to next-priority extractor before ultimate failure

  # MIME Type Detection & Format Routing
  - name: mime-detector
    role: Detect document formats and route to appropriate handlers
    context:
      - Source: crates/kreuzberg/src/core/mime.rs
      - Key concepts:
          - MIME type detection from extension, magic bytes, content
          - Legacy Office format conversion (DOC→DOCX, PPT→PPTX)
          - Format-to-extractor mapping
          - Multi-format support
    capabilities:
      - Correctly identify document formats
      - Handle edge cases (no extension, incorrect extension, mixed formats)
      - Route to correct extractor implementation
      - Detect and convert legacy formats
    patterns:
      - Detection uses file extension + magic bytes + content analysis
      - Legacy formats converted via LibreOffice before extraction
      - Unknown formats default to fallback extractor

  # Cache Management
  - name: cache-manager
    role: Optimize extraction performance through intelligent caching
    context:
      - Key concepts:
          - Content-based hashing for cache keys
          - Persistent cache storage
          - Cache invalidation on config changes
          - Cache statistics and monitoring
    capabilities:
      - Design and implement caching strategies
      - Optimize cache hit rates
      - Monitor cache performance metrics
      - Handle cache invalidation
    patterns:
      - Cache keys based on file content hash, not filename
      - Cache invalidated when extraction config changes
      - Sub-millisecond cache lookups
      - 40-60% cache hit rate in production

  # Error Handling & Recovery
  - name: error-recovery-specialist
    role: Implement robust error handling and fallback strategies
    context:
      - Source: crates/kreuzberg/src/error.rs
      - Key concepts:
          - Error type classification (Validation, Parsing, OCR, Dependencies)
          - Fallback extractor chains
          - Error context preservation
          - Batch operation resilience
    capabilities:
      - Design error recovery strategies
      - Implement graceful degradation
      - Debug extraction failures
      - Ensure batch operations continue on partial failures
    patterns:
      - Primary extractor failure triggers next-priority fallback
      - Error context captured for debugging
      - Batch operations track per-document errors
      - Partial results returned with error metadata

  # Configuration Management
  - name: config-manager
    role: Manage extraction configuration and behavior customization
    context:
      - Source: crates/kreuzberg-py/src/config.rs
      - Key concepts:
          - ExtractionConfig cascade
          - PDF, Office, OCR, chunking, embedding configs
          - Per-extractor configuration
          - Config validation
    capabilities:
      - Design flexible configuration systems
      - Validate configuration values
      - Apply configs to specific extractors
      - Understand config impact on output
    patterns:
      - Single ExtractionConfig controls all extractor behavior
      - Extractors read config to customize processing
      - Config validation prevents invalid combinations
      - Different extractors may use different config sections
